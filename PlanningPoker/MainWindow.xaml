<Window x:Class="PlanningPoker.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:entity="clr-namespace:PlanningPoker.Entity"
        Title="Planning Poker -- Powered By Yiming Bao" 
        WindowStartupLocation="CenterScreen"
        Height="700" Width="1100" 
        Icon="/Resources/planningpoker.ico"
        Loaded="Window_Loaded"
        Closed="Window_Closed">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- mainpulation area -->
        <Grid Grid.Column="0" >
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" MinHeight="40"/>
                    <RowDefinition Height="*" MinHeight="300" />
                    <RowDefinition Height="Auto" MinHeight="140"/>
                </Grid.RowDefinitions>
                <Grid.Background>
                    <!--https://msdn.microsoft.com/en-us/library/aa212292%28office.11%29.aspx-->
                    <RadialGradientBrush>
                        <GradientStop Color="Gold" Offset="0" />
                        <GradientStop Color="Chocolate" Offset="1" />
                    </RadialGradientBrush>
                </Grid.Background>
                <Grid Grid.Row="0">
                    <TextBox Text="{Binding ElementName=lbStoryList, Path=SelectedItem.Title}" 
                             TextWrapping="WrapWithOverflow" 
                             AcceptsReturn="True" 
                             MaxHeight="100"
                             VerticalScrollBarVisibility="Auto"
                             VerticalContentAlignment="Center"/>
                </Grid>
                <Grid Grid.Row="1">
                    <ItemsControl Name="participants" ItemsSource="{Binding Participants}" ItemTemplate="{StaticResource ParticipantsTemplate}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel ScrollViewer.HorizontalScrollBarVisibility="Hidden"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>
                </Grid>
                <Grid Grid.Row="2">
                    <ListBox Name="lbCardSequence"
                        IsSynchronizedWithCurrentItem="True" 
                             ItemContainerStyle="{StaticResource singleCheckListBox}"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"
                             ItemsSource="{Binding CardSquence}"
                             BorderThickness="0"
                             Background="Transparent"
                             SelectionChanged="lbCardSequence_SelectionChanged">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel Margin="10, 20, 5, 5" Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                    </ListBox>
                </Grid>
            </Grid>

        </Grid>
        <GridSplitter Width="3"/>
        <!--Story list -->
        <Grid Name="rightPanel" Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <Grid Grid.Row="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="40"/>
                    <RowDefinition Height="40"/>
                    <RowDefinition Height="40"/>
                    <RowDefinition Height="40"/>
                    <RowDefinition Height="120"/>
                    <RowDefinition Height="Auto" MinHeight="40"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="85"/>
                </Grid.ColumnDefinitions>
                <TextBox Grid.Row="0" Grid.Column="0" Name="txtUserName" 
                         Text="{Binding UserName}" 
                         FontSize="14" 
                         VerticalContentAlignment="Center" />
                <ComboBox Grid.Row="0"
                          Name="cbRole"
                          Grid.Column="1" 
                          Text="{Binding Role}"
                          IsEditable="True" 
                          VerticalContentAlignment="Center">
                </ComboBox>

                <TextBox Grid.Row="1" Grid.Column="0" Name="txtLocalIP" VerticalContentAlignment="Center"/>
                <Button Grid.Row="1" Grid.Column="1" Name="btnStart" Content="Start" VerticalContentAlignment="Center" Click="btnStart_Click"/>
                <Ellipse Grid.Row="1" Grid.Column="1" Fill="Green" Visibility="{Binding CanStartService}" Width="10" Height="10" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="5"/>

                <TextBox Grid.Row="2" Grid.Column="0" Name="txtServerIP" VerticalContentAlignment="Center"/>
                <Button Grid.Row="2" Grid.Column="1" Name="btnConnect" Content="Connect" VerticalContentAlignment="Center" Click="btnConnect_Click"/>
                <Ellipse Grid.Row="2" Grid.Column="1" Fill="Green" Visibility="{Binding CanConnectServer}" Width="10" Height="10" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="5"/>

                <DockPanel Grid.Row="3" Grid.ColumnSpan="2">
                    <Button Grid.Column="2" Name="btnReset" Content="Reset" Width="85" DockPanel.Dock="Right" VerticalContentAlignment="Center" Click="btnReset_Click"/>
                    <Button Grid.Column="1" Name="btnFlip" Content="Flip" Width="85" DockPanel.Dock="Right" VerticalContentAlignment="Center" Click="btnFlip_Click"/>
                    <CheckBox Grid.Column="0" Name="ckAutoFlip" Content="Auto Flip" IsChecked="{Binding AutoFlip}" VerticalAlignment="Center" VerticalContentAlignment="Center"/>
                    <!--Style="{StaticResource SliderCheckBox}"-->
                </DockPanel>
                <Label Grid.Row="4" Grid.ColumnSpan="2"  
                       Foreground="Orange"
                       Background="MediumSeaGreen" 
                       FontSize="36"
                       FontWeight="ExtraBold" 
                       Content="{Binding Score}" 
                       HorizontalContentAlignment="Center" 
                       VerticalContentAlignment="Center"/>

                <TextBox Grid.Row="5" Grid.Column="0" Name="txtQuery"
                        Text="{Binding QueryString}"
                         VerticalContentAlignment="Center" 
                         MaxHeight="100" 
                         AcceptsReturn="True"
                         TextWrapping="WrapWithOverflow" 
                         Grid.RowSpan="2"/>
                <Button Grid.Row="5" Grid.Column="1" Name="btnQuery" Content="Query" VerticalContentAlignment="Center" Click="btnQuery_Click" Grid.RowSpan="2"/>
            </Grid>
            <ListBox Name="lbStoryList" Grid.Row="1" ItemContainerStyle="{StaticResource listBoxItemMouseOver}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <Label Content="{Binding Severity}" Grid.Row="0" Grid.Column="0"
                                   ToolTip="严重程度"/>
                            <Label Content="{Binding ID}" Grid.Row="0" Grid.Column="1" 
                                   ToolTip="ID"/>
                            <Label Content="{Binding Title}" Grid.Row="0" Grid.Column="2"
                                   ToolTip="标题"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

        </Grid>
    </Grid>


</Window>
